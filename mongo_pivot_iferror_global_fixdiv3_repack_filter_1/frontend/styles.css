:root{--bg:#0b1220;--card:#121a2b;--muted:#7f8ca3;--hl-row:#0f1f3a;--hl-col:#0e2442;--hl-hit:#173a68}
*{box-sizing:border-box} html,body{height:100%;margin:0}
body{background:#0b1220;color:#e7ecf6;font-family:system-ui,Segoe UI,Roboto,Arial}
.container{display:flex;gap:0;padding:16px;height:calc(100vh - 32px)}
.panel{background:#121a2bcc;border:1px solid #ffffff12;border-radius:14px;padding:12px;box-shadow:0 10px 30px #0006;width:420px;min-width:300px;max-width:800px;position:relative;margin-right:16px;transition:all 0.3s ease;flex-shrink:0}
.panel:last-child{flex:1;width:auto;min-width:400px;max-width:none;margin-right:0}
.filter-panel{background:#121a2bcc;border:1px solid #ffffff12;border-radius:14px;padding:12px;box-shadow:0 10px 30px #0006;width:280px;min-width:200px;max-width:500px;position:relative;margin-right:0;transition:all 0.3s ease}
.filter-panel.collapsed{width:60px;min-width:60px;overflow:visible;padding:8px 4px}
.panel.collapsed{width:60px;min-width:60px;overflow:visible;padding:8px 4px}
.panel-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;position:relative}
.panel-toggle{background:#2a374d;border:1px solid #4a5568;color:#e7ecf6;padding:6px 10px;border-radius:8px;cursor:pointer;font-size:14px;min-width:32px;width:auto;transition:all 0.2s ease;display:flex;align-items:center;justify-content:center}
.panel-toggle:hover{background:#334155;border-color:#5a6578;transform:scale(1.05)}
.panel-toggle:active{background:#3b4a5d;transform:scale(0.98)}

/* 折叠状态下的展开按钮样式 */
.filter-panel.collapsed .panel-toggle,
.panel.collapsed .panel-toggle{
  position:absolute;
  top:8px;
  left:50%;
  transform:translateX(-50%);
  width:36px;
  height:36px;
  border-radius:50%;
  font-size:16px;
  font-weight:bold;
  z-index:100;
  box-shadow:0 2px 8px rgba(0,0,0,0.3);
  background:#3b82f6;
  border-color:#2563eb;
  margin:0;
  padding:0;
}
.filter-panel.collapsed .panel-toggle:hover,
.panel.collapsed .panel-toggle:hover{
  background:#2563eb;
  border-color:#1d4ed8;
  transform:translateX(-50%) scale(1.1);
  box-shadow:0 4px 12px rgba(59,130,246,0.4);
}
.filter-panel.collapsed .panel-toggle:active,
.panel.collapsed .panel-toggle:active{
  background:#1d4ed8;
  transform:translateX(-50%) scale(1.05);
}

/* 折叠状态下隐藏标题但保留重要按钮 */
.filter-panel.collapsed .panel-header h2,
.panel.collapsed .panel-header h1{
  display:none;
}

/* 筛选器面板：折叠状态下保留重要按钮 */
.filter-panel.collapsed > *:not(.panel-header):not(.row){
  display:none;
}
.filter-panel.collapsed .row{
  position:absolute;
  top:60px;
  left:4px;
  right:4px;
  display:flex;
  flex-direction:column;
  gap:8px;
  margin:0;
}
.filter-panel.collapsed .row button{
  width:48px;
  height:32px;
  padding:4px;
  font-size:10px;
  text-align:center;
  line-height:1.2;
  border-radius:6px;
  margin:0;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* 配置面板：折叠状态下保留关键按钮 */
.panel.collapsed > *:not(.panel-header):not(.collapsed-buttons){
  display:none;
}

/* 为配置面板添加折叠状态下的按钮容器 */
.panel.collapsed .collapsed-buttons{
  position:absolute;
  top:60px;
  left:4px;
  right:4px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.panel.collapsed .collapsed-buttons button{
  width:48px;
  height:28px;
  padding:2px;
  font-size:9px;
  text-align:center;
  line-height:1.1;
  border-radius:4px;
  margin:0;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* 折叠状态下按钮的hover效果 */
.filter-panel.collapsed button:not(.panel-toggle):hover,
.panel.collapsed button:not(.panel-toggle):hover{
  background:#334155;
  border-color:#5a6578;
  transform:scale(1.05);
  z-index:110;
  position:relative;
}
.resize-handle{position:absolute;top:0;right:-8px;width:16px;height:100%;cursor:col-resize;background:transparent;z-index:10}
.resize-handle:hover{background:rgba(74,144,226,0.1)}
.resize-handle::after{content:'';position:absolute;top:50%;left:50%;width:2px;height:40px;background:#4a5568;transform:translate(-50%,-50%);border-radius:1px}
.resize-handle:hover::after{background:#4a90e2}
.filter-container{max-height:400px;overflow-y:auto;scrollbar-width:thin;scrollbar-color:#4a5568 #1a202c}
.filter-container::-webkit-scrollbar{width:6px}
.filter-container::-webkit-scrollbar-track{background:#1a202c;border-radius:3px}
.filter-container::-webkit-scrollbar-thumb{background:#4a5568;border-radius:3px}
.filter-container::-webkit-scrollbar-thumb:hover{background:#5a6578}
.filter-section{margin-bottom:16px}
.filter-list{max-height:160px;overflow-y:auto}
.filter-item{margin:4px 0;padding:6px;background:#0f1627;border:1px solid #2a374d;border-radius:6px}
.filter-item label{margin:0 0 4px;font-size:11px;color:#aab6cf}
.filter-item input{margin:0;font-size:11px}
.filter-item select{margin:0;font-size:11px}
h1{margin:0 0 10px;font-size:18px} h2{margin:14px 0 8px;font-size:14px;color:#cbd5e1} h3{margin:8px 0 4px;font-size:12px;color:#aab6cf}
label{display:block;margin:8px 0 4px;color:var(--muted);font-size:12px}
.switch{display:flex;align-items:center;gap:8px}
input,select,textarea,button{width:100%;background:#0f1627;border:1px solid #2a374d;color:#e7ecf6;padding:8px 10px;border-radius:8px;outline:none}
button{cursor:pointer;background:linear-gradient(90deg,#3b82f6,#1e40af);border:none;margin-top:8px} button.secondary{background:#0f1627;border:1px solid #2a374d}
button:disabled{opacity:0.6;cursor:not-allowed}
.small{font-size:12px;color:#9fb0c7} .grid2{display:grid;grid-template-columns:1fr 1fr;gap:8px} .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.badge{padding:2px 8px;border:1px solid #2a374d;border-radius:999px}
.fields-box{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.fields-box-new{display:grid;grid-template-columns:1fr 1fr;gap:16px;align-items:start}
.fields-available{min-height:200px}
.fields-available .list{max-height:240px;overflow-y:auto;scrollbar-width:thin;scrollbar-color:#4a5568 #1a202c}
.fields-available .list::-webkit-scrollbar{width:6px}
.fields-available .list::-webkit-scrollbar-track{background:#1a202c;border-radius:3px}
.fields-available .list::-webkit-scrollbar-thumb{background:#4a5568;border-radius:3px}
.fields-available .list::-webkit-scrollbar-thumb:hover{background:#5a6578}
.fields-zones{display:grid;grid-template-rows:auto auto auto;gap:12px}
.fields-zones > div{margin:0}
.fields-zones h3{margin:4px 0 6px;font-size:11px}
.fields-zones .dropzone{min-height:60px;padding:6px}
.list,.dropzone{min-height:80px;background:#0f1627;border:1px dashed #334155;border-radius:8px;padding:8px}
.field{display:inline-flex;gap:6px;align-items:center;background:#0f172a;border:1px solid #334155;border-radius:999px;padding:4px 8px;margin:4px}
.fields-zones .field{margin:2px 3px;padding:3px 6px;font-size:11px}
.fields-zones .field .remove{font-size:10px;margin-left:3px}
.fields-zones .field .agg{font-size:10px;margin:0 2px;padding:1px 3px}
.cloud-item{margin:4px 0;padding:8px;background:#0f1627;border:1px solid #2a374d;border-radius:6px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:all 0.2s}
.cloud-item:hover{background:#1a2332;border-color:#3b4a5d}
.cloud-item span:first-child{flex:1;color:#e7ecf6;font-weight:500}
.cloud-item span:first-child:hover{color:#60a5fa}
.cloud-item .remove{margin-left:8px;color:#f87171;cursor:pointer;padding:2px 6px;border-radius:4px;transition:background 0.2s}
.cloud-item .remove:hover{background:#dc262633}
.log{height:160px;background:#0f1627;border:1px solid #ffffff12;border-radius:8px;padding:8px;overflow:auto}
.pivot table{border-collapse:collapse;width:100%} .pivot th,.pivot td{border:1px solid #384152;padding:6px 8px;font-size:12px} .pivot th{background:#0f172a;position:sticky;top:0}
.total{background:#0e1a2e;font-weight:600}
.pivot.crosshair td.hl-col{background:var(--hl-col)}
.pivot.crosshair tr.hl-row td{background:var(--hl-row)}
.pivot.crosshair td.hl-hit{background:var(--hl-hit)!important}
.pivot tbody tr:nth-child(odd) td{background:#0e1424}
.pivot .summary-row td{background:#1a2332!important;font-weight:bold;border-top:2px solid #4a5568}
.pivot .subtotal-row td{background:#162032!important;font-weight:bold;border-top:1px solid #334155}
.pivot th{position:relative}
.pivot .column-resizer{position:absolute;top:0;right:0;width:4px;height:100%;cursor:col-resize;background:transparent;border-right:2px solid transparent;transition:border-color 0.2s}
.pivot .column-resizer:hover{border-right-color:#4a90e2}
.pivot .column-resizer:active{border-right-color:#2563eb}
.pivot .sort-indicator{margin-left:5px;opacity:0.5;font-size:10px;transition:opacity 0.2s}
.pivot th[data-sortable]:hover .sort-indicator{opacity:0.8}
.pivot th[data-sortable]:hover{background-color:#1a2332}
#formatPanel{max-height:300px;overflow-y:auto;scrollbar-width:thin;scrollbar-color:#4a5568 #1a202c}
#formatPanel::-webkit-scrollbar{width:6px}
#formatPanel::-webkit-scrollbar-track{background:#1a202c;border-radius:3px}
#formatPanel::-webkit-scrollbar-thumb{background:#4a5568;border-radius:3px}
#formatPanel::-webkit-scrollbar-thumb:hover{background:#5a6578}
.metric-card{margin-bottom:12px;padding:10px;background:#0e1a2e;border:1px solid #2a374d;border-radius:8px}
.metric-title{font-weight:bold;margin-bottom:8px;color:#e7ecf6;font-size:13px}
.metric-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.metric-grid label{margin:4px 0;font-size:11px}
.metric-grid input,.metric-grid select{width:100%;font-size:11px;padding:4px 6px}

/* 冻结控件样式 */
.freeze-controls{background:#0e1a2e;border:1px solid #2a374d;border-radius:8px;padding:12px;margin-bottom:12px}
.freeze-controls h3{margin:0 0 8px;font-size:13px;color:#e7ecf6}
.freeze-inputs{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
.freeze-inputs label{margin:0;font-size:12px;color:#aab6cf;white-space:nowrap}
.freeze-inputs input{width:60px;margin-left:6px;font-size:12px;padding:4px 6px}
.freeze-inputs button{width:auto;margin:0;padding:6px 12px;font-size:12px}

/* 表格滚动容器 */
.table-scroll-container{
  height:calc(100vh - 200px);
  overflow:auto;
  border:1px solid #ffffff12;
  border-radius:8px;
  background:#0b1220;
}

/* 冻结表格样式 */
.pivot.frozen{
  position:relative;
  white-space:nowrap;
}

.pivot.frozen table{
  border-collapse:separate;
  border-spacing:0;
}

.pivot table{
  width:100%;
}

.pivot.frozen thead th.frozen-col{
  position:sticky;
  left:0;
  z-index:12;
  background:#0f172a;
  border-right:2px solid #4a5568;
  box-shadow:1px 0 0 0 #4a5568;
}

.pivot.frozen thead th.frozen-row{
  position:sticky;
  top:0;
  z-index:11;
  background:#0f172a;
  border-bottom:2px solid #4a5568;
  box-shadow:0 1px 0 0 #4a5568;
}

.pivot.frozen thead th.frozen-corner{
  position:sticky;
  top:0;
  left:0;
  z-index:13;
  background:#0f172a;
  border-right:2px solid #4a5568;
  border-bottom:2px solid #4a5568;
  box-shadow:1px 1px 0 0 #4a5568;
}

.pivot.frozen tbody td.frozen-col{
  position:sticky;
  left:0;
  z-index:10;
  background:#0e1424;
  border-right:2px solid #4a5568;
  box-shadow:1px 0 0 0 #4a5568;
}

.pivot.frozen tbody tr:nth-child(odd) td.frozen-col{
  background:#0e1424;
}

.pivot.frozen tbody tr.subtotal-row td.frozen-col{
  background:#162032!important;
}

.pivot.frozen tbody tr.summary-row td.frozen-col{
  background:#1a2332!important;
}

/* 滚动条样式 */
.table-scroll-container::-webkit-scrollbar{width:8px;height:8px}
.table-scroll-container::-webkit-scrollbar-track{background:#1a202c;border-radius:4px}
.table-scroll-container::-webkit-scrollbar-thumb{background:#4a5568;border-radius:4px}
.table-scroll-container::-webkit-scrollbar-thumb:hover{background:#5a6578}
.table-scroll-container::-webkit-scrollbar-corner{background:#1a202c}
